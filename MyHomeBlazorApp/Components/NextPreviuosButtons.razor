@using BlazorBootstrap
@inject BlazorData.DataService DataService
@using MyHome.Models


@if (CurrentDevice != null && CurrentDevice.DeviceID != DevicesListAsQueryable.First().DeviceID)
{
    <Button style="margin:5px" Class="buttonsNextPreviuos" @onclick="OnModalDevicePreviuos">Previuos</Button>
}
else
{
    <Button style="margin:5px" Class="buttonsNextPreviuos" Disabled @onclick="OnModalDevicePreviuos">Previuos</Button>
}

@if (CurrentDevice != null && CurrentDevice.DeviceID != DevicesListAsQueryable.Last().DeviceID)
{
    <Button style="margin:5px" Class="buttonsNextPreviuos" @onclick="OnModalDeviceNext">Next</Button>
}
else
{
    <Button style="margin:5px" Class="buttonsNextPreviuos" Disabled @onclick="OnModalDeviceNext">Next</Button>
}

<style>
    .buttonsNextPreviuos {
        align-items: flex-end;
        background-color: white;
        background-position: 0 0;
        border: 1px solid black;
        border-radius: 11px;
        box-sizing: border-box;
        color: black;
        cursor: pointer;
        display: inline-block;
        font-size: 1rem;
        font-weight: 700;
        line-height: 33.4929px;
        list-style: outside url(https://www.smashingmagazine.com/images/bullet.svg) none;
        padding: 2px 12px;
        text-align: right;
        text-decoration: none;
        text-shadow: none;
        text-underline-offset: 1px;
        transition: border .2s ease-in-out,box-shadow .2s ease-in-out;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        white-space: nowrap;
        word-break: break-word;
    }

        .buttonsNextPreviuos:active,
        .buttonsNextPreviuos:hover,
        .buttonsNextPreviuos:focus {
            outline: 0;
        }


        .buttonsNextPreviuos:active {
            background-color: black;
            box-shadow: rgba(0, 0, 0, 0.12) 0 1px 3px 0 inset;
            color: #FFFFFF;
        }

        .buttonsNextPreviuos:hover {
            background-color: black;
            border-color: black;
            color:white;
        }

        .buttonsNextPreviuos:active:hover,
        .buttonsNextPreviuos:focus:hover,
        .buttonsNextPreviuos:focus {
            background-color: black;
            box-shadow: rgba(0, 0, 0, 0.12) 0 1px 3px 0 inset;
            color: #FFFFFF;
        }
</style>

@code{
    [Parameter]
    public IQueryable<DeviceProfile>? DevicesListAsQueryable { get; set; }
    [Parameter]
    public DeviceProfile? CurrentDevice {get;set;}
    [Parameter]
    public EventCallback<DeviceProfile> CurrentDeviceChanged { get; set; }
    private int CurrentDeviceIndex = 0;

    private async Task OnModalDeviceNext()
    {
        if (CurrentDevice != null)
        {
            CurrentDeviceIndex = DevicesListAsQueryable.ToList().IndexOf(CurrentDevice);
            CurrentDevice = DevicesListAsQueryable.ToList()[CurrentDeviceIndex + 1];
            await CurrentDeviceChanged.InvokeAsync(CurrentDevice);
            //one line code with linq
            // CurrentDevice = allDevices[(allDevices.IndexOf(CurrentDevice) + 1) % allDevices.Count];
        }
    }

    private async Task OnModalDevicePreviuos()
    {
        if (CurrentDevice != null)
        {
            CurrentDeviceIndex = DevicesListAsQueryable.ToList().IndexOf(CurrentDevice);
            CurrentDevice = DevicesListAsQueryable.ToList()[CurrentDeviceIndex - 1];
            await CurrentDeviceChanged.InvokeAsync(CurrentDevice);
        }
    }
}