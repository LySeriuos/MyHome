@using BlazorBootstrap
@inject BlazorData.DataService DataService
@using MyHome.Models

<Modal @ref="refModalEditShopDetails" Title="Edit Shop Details">
    <BodyTemplate>
        <EditForm Model="@CurrentDevice" Context="ShopDetails" OnSubmit="ShopDetailsFormSubmitted">
            <AddEditShopDetailsComponent CurrentDevice="@CurrentDevice" />
            <AddressComponent DisplaySubmitButton="false" CurrentObjectAddress="@ShopAddress" />
            <NextPreviuosButtons @bind-CurrentDevice="@CurrentDevice"></NextPreviuosButtons>
            <Button Color="ButtonColor.Primary" @onclick="OnHideModalEditAddShopClick">Close</Button>
            <Button Color="ButtonColor.Primary" Type="ButtonType.Submit">Save changes</Button>
        </EditForm>
    </BodyTemplate>
</Modal>

@code {
    private Modal? refModalEditShopDetails { get; set; }
    [Parameter]
    public DeviceProfile? CurrentDevice { get; set; }
    [Parameter]
    public Address? ShopAddress { get; set; }
    [Parameter]
    public EditContext? Context { get; set; }

    public async Task OnHideModalEditAddShopClick()
    {
        await refModalEditShopDetails.HideAsync();
    }

    public async Task OnShowModalEditAddShopClick()
    {
        await refModalEditShopDetails.ShowAsync();
    }

    private void ShopDetailsFormSubmitted(EditContext Context)
    {
        DataService.SaveUpdatedObject();
        refModalEditShopDetails.HideAsync();
    }
}
